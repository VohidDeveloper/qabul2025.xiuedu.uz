{"version":3,"file":"Login-Fia3DD4_.js","sources":["../../src/pages/auth/Login.vue"],"sourcesContent":["<template>\n  <VaForm @submit.prevent=\"submit\">\n    <h1 class=\"text-2xl font-bold mb-4\">üì≤ Tizimga kirish</h1>\n\n    <VaInput\n      v-model=\"phone\"\n      label=\"Telefon raqamingiz\"\n      :rules=\"[(v) => !!v || 'Telefon raqam kerak']\"\n      placeholder=\"+998901234567\"\n      class=\"mb-4\"\n    />\n\n    <VaInput\n      v-if=\"isCodeStep\"\n      v-model=\"code\"\n      label=\"SMS kodi\"\n      :rules=\"[(v) => !!v || 'Kod kerak']\"\n      placeholder=\"1234\"\n      class=\"mb-4\"\n    />\n\n    <VaButton class=\"w-full\" :loading=\"loading\" @click=\"submit\">\n      {{ isCodeStep ? '‚úÖ Tasdiqlash' : '‚û°Ô∏è Kod yuborish' }}\n    </VaButton>\n  </VaForm>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useToast } from 'vuestic-ui'\nimport { useAuthStore } from '@/stores/auth-store'\n\nconst authStore = useAuthStore()\nconst router = useRouter()\nconst toast = useToast()\n\nconst phone = ref('')\nconst code = ref('')\nconst isCodeStep = ref(false)\nconst loading = ref(false)\n\nconst submit = async () => {\n  if (!phone.value) {\n    toast.init({ message: 'üìµ Telefon raqamingizni kiriting', color: 'danger' })\n    return\n  }\n\n  if (isCodeStep.value && !code.value) {\n    toast.init({ message: 'üîë Tasdiqlash kodini kiriting', color: 'danger' })\n    return\n  }\n\n  loading.value = true\n  try {\n    if (!isCodeStep.value) {\n      await authStore.startAuth(phone.value)\n      authStore.phone = phone.value\n      isCodeStep.value = true\n      toast.init({ message: 'üì© SMS kodi yuborildi', color: 'info' })\n    } else {\n      await authStore.verifyCode(code.value)\n      toast.init({ message: '‚úÖ Tizimga kirildi!', color: 'success' })\n\n      switch (authStore.role) {\n        case 'admin':\n          router.push({ name: 'dashboard' })\n          break\n        case 'commission':\n          router.push({ name: 'commission-dashboard' })\n          break\n        case 'applicant':\n          router.push({ name: 'application-form' })\n          break\n        default:\n          toast.init({ message: '‚ùì Ruxsat etilmagan role.', color: 'warning' })\n          router.push({ name: '404' })\n      }\n\n      console.log('Foydalanuvchi:', authStore.user)\n      console.log('Role:', authStore.role)\n    }\n  } catch (err: any) {\n    toast.init({\n      message: err?.response?.data?.detail || err?.message || '‚ùå Xatolik yuz berdi',\n      color: 'danger',\n    })\n    console.error('Login xatoligi:', err)\n  } finally {\n    loading.value = false\n  }\n}\n</script>\n"],"names":["authStore","useAuthStore","router","useRouter","toast","useToast","phone","ref","code","isCodeStep","loading","submit","err","_b","_a"],"mappings":"kNAiCA,MAAMA,EAAYC,IACZC,EAASC,IACTC,EAAQC,IAERC,EAAQC,EAAI,EAAE,EACdC,EAAOD,EAAI,EAAE,EACbE,EAAaF,EAAI,EAAK,EACtBG,EAAUH,EAAI,EAAK,EAEnBI,EAAS,SAAY,SACrB,GAAA,CAACL,EAAM,MAAO,CAChBF,EAAM,KAAK,CAAE,QAAS,mCAAoC,MAAO,SAAU,EAC3E,MACF,CAEA,GAAIK,EAAW,OAAS,CAACD,EAAK,MAAO,CACnCJ,EAAM,KAAK,CAAE,QAAS,gCAAiC,MAAO,SAAU,EACxE,MACF,CAEAM,EAAQ,MAAQ,GACZ,GAAA,CACE,GAAA,CAACD,EAAW,MACR,MAAAT,EAAU,UAAUM,EAAM,KAAK,EACrCN,EAAU,MAAQM,EAAM,MACxBG,EAAW,MAAQ,GACnBL,EAAM,KAAK,CAAE,QAAS,wBAAyB,MAAO,OAAQ,MACzD,CAIL,OAHM,MAAAJ,EAAU,WAAWQ,EAAK,KAAK,EACrCJ,EAAM,KAAK,CAAE,QAAS,qBAAsB,MAAO,UAAW,EAEtDJ,EAAU,KAAM,CACtB,IAAK,QACHE,EAAO,KAAK,CAAE,KAAM,WAAa,CAAA,EACjC,MACF,IAAK,aACHA,EAAO,KAAK,CAAE,KAAM,sBAAwB,CAAA,EAC5C,MACF,IAAK,YACHA,EAAO,KAAK,CAAE,KAAM,kBAAoB,CAAA,EACxC,MACF,QACEE,EAAM,KAAK,CAAE,QAAS,2BAA4B,MAAO,UAAW,EACpEF,EAAO,KAAK,CAAE,KAAM,KAAO,CAAA,CAC/B,CAEQ,QAAA,IAAI,iBAAkBF,EAAU,IAAI,EACpC,QAAA,IAAI,QAASA,EAAU,IAAI,CACrC,QACOY,EAAU,CACjBR,EAAM,KAAK,CACT,UAASS,GAAAC,EAAAF,GAAA,YAAAA,EAAK,WAAL,YAAAE,EAAe,OAAf,YAAAD,EAAqB,UAAUD,GAAA,YAAAA,EAAK,UAAW,sBACxD,MAAO,QAAA,CACR,EACO,QAAA,MAAM,kBAAmBA,CAAG,CAAA,QACpC,CACAF,EAAQ,MAAQ,EAClB,CAAA"}