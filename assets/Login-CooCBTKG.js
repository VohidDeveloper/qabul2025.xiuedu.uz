import{g as V,$ as y,a0 as _,h as u,r as c,e as g,k as f,w as v,a as S,d as k,G as T,f as w,t as x,L as C}from"./index-BZ-BXCh5.js";import{u as q}from"./useToast-CM91r3xC.js";const F=V({__name:"Login",setup(z){const s=y(),i=_(),l=q(),t=u(""),r=u(""),n=u(!1),d=u(!1),p=async()=>{var m,a;if(!t.value){l.init({message:"üìµ Telefon raqamingizni kiriting",color:"danger"});return}if(n.value&&!r.value){l.init({message:"üîë Tasdiqlash kodini kiriting",color:"danger"});return}d.value=!0;try{if(!n.value)await s.startAuth(t.value),s.phone=t.value,n.value=!0,l.init({message:"üì© SMS kodi yuborildi",color:"info"});else{switch(await s.verifyCode(r.value),l.init({message:"‚úÖ Tizimga kirildi!",color:"success"}),s.role){case"admin":i.push({name:"dashboard"});break;case"commission":i.push({name:"commission-dashboard"});break;case"applicant":i.push({name:"application-form"});break;default:l.init({message:"‚ùì Ruxsat etilmagan role.",color:"warning"}),i.push({name:"404"})}console.log("Foydalanuvchi:",s.user),console.log("Role:",s.role)}}catch(e){l.init({message:((a=(m=e==null?void 0:e.response)==null?void 0:m.data)==null?void 0:a.detail)||(e==null?void 0:e.message)||"‚ùå Xatolik yuz berdi",color:"danger"}),console.error("Login xatoligi:",e)}finally{d.value=!1}};return(m,a)=>{const e=c("VaInput"),h=c("VaButton"),b=c("VaForm");return g(),f(b,{onSubmit:C(p,["prevent"])},{default:v(()=>[a[2]||(a[2]=S("h1",{class:"text-2xl font-bold mb-4"},"üì≤ Tizimga kirish",-1)),k(e,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=o=>t.value=o),label:"Telefon raqamingiz",rules:[o=>!!o||"Telefon raqam kerak"],placeholder:"+998901234567",class:"mb-4"},null,8,["modelValue","rules"]),n.value?(g(),f(e,{key:0,modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value=o),label:"SMS kodi",rules:[o=>!!o||"Kod kerak"],placeholder:"1234",class:"mb-4"},null,8,["modelValue","rules"])):T("",!0),k(h,{class:"w-full",loading:d.value,onClick:p},{default:v(()=>[w(x(n.value?"‚úÖ Tasdiqlash":"‚û°Ô∏è Kod yuborish"),1)]),_:1},8,["loading"])]),_:1})}}});export{F as default};
//# sourceMappingURL=Login-CooCBTKG.js.map
